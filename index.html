<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Aaroneo.us</title>

    <!-- Bootstrap -->
    <link href="bootstrap-3.3.2-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap-3.3.2-dist/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top" style="display:none">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Bootstrap theme</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container theme-showcase" role="main">
      <div class="jumbotron">
        <h1>Coming Soon(ish)...</h1>
        <p>A new side project for a bored developer with little actual free-time on his hands.</p>
      </div>


      <div class="page-header">
        <h1>Bootstrapping for now, <em>nous allons voir si ce arrive.</em></h1>
      </div>
      <div class="page-content container">
        <div class="row">
          <div class="col-12">
            <h2>AWS CLI (but really python) woes</h2>
            <p>I'm currently working on an application with lots of foreign users who (unsurprisingly)
            like to upload documents with unicode characters in their names. Today, we're alerted to a file
            which can't be opened because its "missing" according Working on an application with
            lots of foreign users who (unsurprisingly) like to upload documents with unicode characters in
            their names. Today, we're alerted to a file which can't be opened because it's "missing" according
            to the app.</p>
            <p>I start digging around s3 using the awscli python package and grepping around the results from
            `aws s3 ls --recursive`. I don't see the file they're looking for, but I do see a very similarly
            named one when I loosen my grep command. All the unicode characters have been replaced by question
            marks in the file name! Okay, somehow we're dealing with a bad interaction with S3, beause, surely,
            S3 can handle unicode filenames. I start poking around the ruby gem we're using to do these uploads
            and despite a few red herrings, it turns out its not rewriting URLs, so it must be a problem with
            how our app is using it.</p>
            <p>I dig around and determine we're also not doing such a modification to the URL! Meanwhile, I scan
            our entire S3 bucket looking for file names with question makrs in their names and find hundreds!
            What gives?!?</p>
            <h3>The culprit</h3>
            <p>I was doing all this searching around S3 using the awscli python package and piping the results
            into grep (and sometimes piping into wc, etc.). But then I noticed, when I did just the `aws s3 ls`
            command, the results in the terminal *did* have the expected unicode characters! The files were there
            and perfectly fine in S3 all along. So is grep the culprit in the question marks? The man page for
            the version of grep I'm using on the El Capitan Mac have this interesting line:</p>
            <blockquote>The grep utility does not normalize Unicode input</blockquote>
            <p>So I brew install ggrep and start using it instead -- but see the same issue... On a lark, I pipe
            the output from awscli into `cat` and voila, still question marks! Piping the output from this python
            cli executable is leading to different output than allowing the results to go directly to the terminal.
            I start doing a little Googling and find that python programs have issues with checking the default
            system encoding (because mine is definitely set to UTF-8, but python says its set to ascii), but
            Stack Overflow yielded this <a href="http://stackoverflow.com/questions/2276200/changing-default-encoding-of-python">gem</a>.</p>
            <p>`export PYTHONIOENCODING=utf8` has now been added to my .bash_profile to avoid this silly problem
            when using the awscli gem in the future. Back to sane piping without losing unicode characters!</p>
            <p class="timestamp">2016-09-15T14:59:38-0400</p>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            <h2>And while trying to deploy this very app,</h2>
            <p>I discovered, Heroku's dyno died on me at least 3 weeks ago. Only a `heroku restart` from the CLI tool
            brought the app back to life. Very unusual/annoying &mdash; I suppose I might have to move to something more
            reliable at some point. The irony is, that something will probably be GitHub...</p>
            <p class="timestamp">2016-04-12T16:04:56-0400</p>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            <h2>Meanwhile,</h2>
            <p>GitHub's <a href="https://github.com/blog/967-github-secrets">"secret" whitespace-ignoring feature</a>
            is apparently not working and it's slowing me down today.</p>
            <p class="timestamp">2016-04-12T15:41:20-0400</p>
          </div>
        </div>
      </div>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap-3.3.2-dist/js/bootstrap.min.js"></script>
  </body>
</html>
